<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>é»é¸å¸•é­¯ - ç©ºæ¸¦é¾</title>

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#101a33;
      --glow1:rgba(58,130,255,.35);
      --glow2:rgba(170,80,255,.30);
      --panel:rgba(20,26,44,.76);
      --panel2:rgba(23,29,49,.88);
      --stroke:rgba(255,255,255,.14);
      --stroke2:rgba(255,255,255,.10);
      --txt:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.70);
      --muted2:rgba(255,255,255,.55);
      --chip:rgba(255,255,255,.10);
      --chip2:rgba(255,255,255,.14);
      --accent:#7fb2ff;
      --shadow: 0 18px 50px rgba(0,0,0,.45);
      --r: 18px;
      --r2: 14px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: "Noto Sans TC", system-ui, -apple-system, "Segoe UI", Arial;
      color:var(--txt);
      background:
        radial-gradient(900px 600px at 18% 12%, var(--glow1), transparent 55%),
        radial-gradient(900px 650px at 88% 20%, var(--glow2), transparent 60%),
        linear-gradient(180deg, var(--bg2), var(--bg1) 70%, #070a12);
      overflow-x:hidden;
    }

    /* subtle animated background */
    .bg-noise{
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.08;
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='220' height='220'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='220' height='220' filter='url(%23n)' opacity='.45'/%3E%3C/svg%3E");
      mix-blend-mode:overlay;
    }

    .stage{
      min-height:100vh;
      padding: 48px 18px 70px;
      display:flex;
      justify-content:center;
      align-items:flex-start;
    }

    .wrap{
      width:min(1120px, 100%);
    }

    .topRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:14px;
      margin-bottom: 14px;
    }

    .titleBox{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .h1{
      margin:0;
      font-size: 40px;
      letter-spacing: .5px;
      text-shadow: 0 10px 25px rgba(0,0,0,.35);
    }
    .sub{
      margin:0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.6;
    }

    .btnGhost{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      padding: 10px 14px;
      border-radius: 14px;
      cursor:pointer;
      box-shadow: 0 12px 26px rgba(0,0,0,.25);
      transition:.15s transform, .15s background;
      user-select:none;
      white-space:nowrap;
    }
    .btnGhost:hover{
      background: rgba(255,255,255,.09);
      transform: translateY(-1px);
    }

    /* main panel */
    .panel{
      background: var(--panel);
      border: 1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      padding: 16px;
      position:relative;
      overflow:hidden;
    }
    .panel:before{
      content:"";
      position:absolute; inset:-2px;
      background: linear-gradient(135deg, rgba(255,255,255,.12), transparent 30%, transparent 70%, rgba(255,255,255,.10));
      opacity:.25;
      pointer-events:none;
    }

    /* filter bar */
    .filters{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      margin-bottom: 14px;
      position:relative;
      z-index:1;
    }

    .input, .select{
      height: 38px;
      border-radius: 12px;
      border: 1px solid var(--stroke2);
      background: rgba(0,0,0,.22);
      color: var(--txt);
      padding: 0 12px;
      outline:none;
      font-size: 13px;
      min-width: 200px;
    }
    .select{min-width: 160px}
    .input::placeholder{color: rgba(255,255,255,.45)}

    .btnMini{
      height: 38px;
      border-radius: 12px;
      border: 1px solid var(--stroke2);
      background: rgba(255,255,255,.08);
      color: var(--txt);
      padding: 0 12px;
      cursor:pointer;
      transition:.15s transform, .15s background;
      user-select:none;
      white-space:nowrap;
      font-size: 13px;
    }
    .btnMini:hover{
      background: rgba(255,255,255,.11);
      transform: translateY(-1px);
    }
    .btnMini.primary{
      border-color: rgba(127,178,255,.45);
      box-shadow: 0 10px 24px rgba(127,178,255,.12);
    }

    /* single card area */
    .cards{
      display:grid;
      grid-template-columns: 1fr;
      gap: 14px;
      position:relative;
      z-index:1;
    }

    .card{
      background: rgba(255,255,255,.06);
      border: 1px solid var(--stroke2);
      border-radius: var(--r);
      padding: 14px;
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
      cursor:pointer;
      transition:.18s transform, .18s background, .18s border;
    }
    .card:hover{
      transform: translateY(-2px);
      background: rgba(255,255,255,.08);
      border-color: rgba(255,255,255,.16);
    }

    .media{
      border-radius: var(--r2);
      overflow:hidden;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      aspect-ratio: 16/7;
      min-height: 220px;
    }
    .media img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
      transform: scale(1.02);
    }

    .meta{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding: 0 4px;
    }
    .name{
      font-size: 18px;
      font-weight: 800;
      margin:0;
    }
    .line{
      font-size: 13px;
      color: var(--muted);
      margin:0;
    }
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin-top: 6px;
    }
    .chip{
      background: var(--chip);
      border: 1px solid rgba(255,255,255,.10);
      color: rgba(255,255,255,.82);
      font-size: 12px;
      padding: 6px 10px;
      border-radius: 999px;
      user-select:none;
    }

    /* ===== detail view ===== */
    #detailView{display:none}
    .detailGrid{
      display:grid;
      grid-template-columns: 440px 1fr;
      gap: 14px;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .detailGrid{grid-template-columns:1fr}
    }

    .detailLeft, .detailRight{
      background: var(--panel2);
      border: 1px solid var(--stroke);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }

    .detailLeft .img{
      width:100%;
      aspect-ratio: 16/10;
      background: rgba(0,0,0,.25);
      overflow:hidden;
    }
    .detailLeft .img img{
      width:100%; height:100%;
      object-fit:cover;
      display:block;
    }

    .detailLeft .info{
      padding: 14px 16px 16px;
    }
    .detailLeft .info h2{
      margin: 0 0 8px;
      font-size: 22px;
    }
    .detailLeft .info p{
      margin: 0;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.7;
    }

    .detailRight{
      padding: 14px 16px 16px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .secTitle{
      font-size: 14px;
      color: rgba(255,255,255,.88);
      margin:0;
      font-weight: 800;
      letter-spacing:.3px;
    }

    .bullets{
      margin: 0;
      padding-left: 18px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.8;
    }

    .actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 4px;
    }

    /* Google CSE panel */
    .cseWrap{
      display:none;
      margin-top: 10px;
      background: rgba(0,0,0,.22);
      border: 1px solid var(--stroke2);
      border-radius: 14px;
      padding: 12px;
    }

    /* Make CSE blend a bit */
    .cseWrap *{
      font-family: inherit !important;
    }
    .cseWrap .gsc-control-cse{
      background: transparent !important;
      border: none !important;
      padding: 0 !important;
    }
    .cseWrap .gsc-search-box{
      margin: 0 0 10px !important;
    }
    .cseWrap input.gsc-input{
      background: rgba(0,0,0,.20) !important;
      color: #fff !important;
      border: 1px solid rgba(255,255,255,.14) !important;
      border-radius: 12px !important;
      padding: 10px 12px !important;
      box-shadow: none !important;
    }
    .cseWrap .gsc-search-button-v2{
      border-radius: 12px !important;
      padding: 10px 14px !important;
    }

    /* tiny note */
    .note{
      color: var(--muted2);
      font-size: 12px;
      margin-top: 8px;
      line-height: 1.6;
    }

  </style>
</head>

<body>
  <div class="bg-noise"></div>

  <div class="stage">
    <div class="wrap">

      <!-- ===== LIST VIEW ===== -->
      <section id="listView">
        <div class="topRow">
          <div class="titleBox">
            <h1 class="h1">é»é¸å¸•é­¯</h1>
            <p class="sub">æœå°‹ + åˆ†é¡ â†’ é»å¡ç‰‡é€²å…¥ä»‹ç´¹ï¼›è¿”å›æœƒå›åˆ°åŸæœ¬ä½ç½®ã€‚</p>
          </div>
          <button class="btnGhost" id="resetBtn" title="é‡ç½®ç¯©é¸">é‡ç½®ç¯©é¸</button>
        </div>

        <div class="panel">
          <div class="filters">
            <input id="searchInput" class="input" placeholder="æœå°‹ï¼šåå­— / å±¬æ€§ / å®šä½ / é—œéµå­—ï¼ˆä¾‹å¦‚ï¼šé£›è¡Œã€åé¨ã€å‚³èªªã€Jetragonï¼‰" />

            <select id="elementSel" class="select">
              <option value="">å…¨éƒ¨å±¬æ€§</option>
              <option value="é£›è¡Œ">é£›è¡Œ</option>
              <option value="ç«">ç«</option>
              <option value="æ°´">æ°´</option>
              <option value="é›·">é›·</option>
              <option value="è‰">è‰</option>
              <option value="æš—">æš—</option>
              <option value="é¾">é¾</option>
              <option value="å†°">å†°</option>
              <option value="åœ°">åœ°</option>
            </select>

            <select id="roleSel" class="select">
              <option value="">å…¨éƒ¨å®šä½</option>
              <option value="åé¨">åé¨</option>
              <option value="è¼¸å‡º">è¼¸å‡º</option>
              <option value="è¼”åŠ©">è¼”åŠ©</option>
              <option value="å·¥ä½œ">å·¥ä½œ</option>
            </select>

            <button class="btnMini" id="densityBtn" title="åˆ‡æ›å¯†åº¦">åˆ‡æ›å¯†åº¦</button>
            <button class="btnMini primary" id="paldbBtn" title="é–‹å•Ÿ PalDB">PalDBï¼šç©ºæ¸¦é¾</button>
            <button class="btnMini" id="googleBtn" title="Google å®˜æ–¹æœå°‹ï¼ˆCSEï¼‰">Google å®˜æ–¹æœå°‹</button>
          </div>

          <!-- Google CSE (collapsed by default) -->
          <div class="cseWrap" id="cseWrap">
            <!-- Google å®˜æ–¹ CSE -->
            <script async src="https://cse.google.com/cse.js?cx=83fa0f7ab19c7423f"></script>
            <div class="gcse-search"></div>

            <div class="note">
              é€™æ˜¯ Google å®˜æ–¹æœå°‹å¼•æ“ï¼ˆCSEï¼‰ã€‚çµæœä¾†è‡ª Google ç´¢å¼•ï¼Œæœƒä¾ä½ åœ¨ CSE æ§åˆ¶å°è¨­å®šçš„ç«™é»ç¯„åœé¡¯ç¤ºã€‚
            </div>
          </div>

          <div class="cards" id="cards"></div>
        </div>
      </section>

      <!-- ===== DETAIL VIEW ===== -->
      <section id="detailView">
        <div class="topRow">
          <div class="titleBox">
            <h1 class="h1" id="detailTitle">ç©ºæ¸¦é¾</h1>
            <p class="sub" id="detailSub">å±¬æ€§ / å®šä½ / ç¨€æœ‰åº¦ / æ‰è½ç‰© / åé¨èƒ½åŠ›</p>
          </div>
          <button class="btnGhost" id="backBtn">â† è¿”å›å¸•é­¯åˆ—è¡¨</button>
        </div>

        <div class="detailGrid">
          <div class="detailLeft">
            <div class="img">
              <img id="detailImg" alt="å¸•é­¯åœ–ç‰‡">
            </div>
            <div class="info">
              <h2 id="detailName">ç©ºæ¸¦é¾ï¼ˆJetragonï¼‰</h2>
              <p id="detailDesc"></p>

              <div class="chips" style="margin-top:10px;">
                <span class="chip" id="chipElement"></span>
                <span class="chip" id="chipRole"></span>
                <span class="chip" id="chipRarity"></span>
              </div>
            </div>
          </div>

          <div class="detailRight">
            <p class="secTitle">ğŸ æ‰è½ç‰©</p>
            <ul class="bullets" id="drops"></ul>

            <p class="secTitle">ğŸ¾ åé¨èƒ½åŠ›</p>
            <div class="bullets" id="mount"></div>

            <div class="actions">
              <button class="btnMini primary" id="openPaldb">çœ‹ PalDB è©³ç´°è³‡æ–™</button>
              <button class="btnMini" id="openMap">é–‹äº’å‹•åœ°åœ–</button>
              <button class="btnMini" id="openGoogle">ç”¨ Google å®˜æ–¹æœå°‹</button>
            </div>

            <div class="note">
              å°æé†’ï¼šæœ‰äº›äº’å‹•åœ°åœ–ç¶²ç«™å¯èƒ½ç¦æ­¢è¢«åµŒå…¥ iframeï¼Œæ‰€ä»¥é€™è£¡ç”¨ã€Œé–‹æ–°åˆ†é ã€æœ€ç©©ã€‚
            </div>
          </div>
        </div>
      </section>

    </div>
  </div>

  <script>
    // ===== Data =====
    const PALS = [
      {
        id: "jetragon",
        name: "ç©ºæ¸¦é¾",
        en: "Jetragon",
        element: "é£›è¡Œ",
        role: ["åé¨","è¼¸å‡º"],
        rarity: "å‚³èªª",
        keywords: ["é£›è¡Œ","åé¨","å‚³èªª","Jetragon","ç©ºæ¸¦é¾"],
        img: "https://xin.18183.com/uploads/allimg/240122/68-240122143I7.jpg",
        desc: "ç©ºæ¸¦é¾æ˜¯æ£²æ¯æ–¼é«˜ç©ºçš„å‚³èªªç´šå¸•é­¯ï¼Œé€Ÿåº¦æ¥µå¿«ï¼Œæ“…é•·ç©ºä¸­å£“åˆ¶èˆ‡é«˜é€Ÿç§»å‹•ï¼Œæ˜¯å¾ŒæœŸæ¢ç´¢èˆ‡æˆ°é¬¥éƒ½å¾ˆå¼·åŠ›çš„åé¨å‹è§’è‰²ã€‚",
        drops: [
          "ï¼ˆå¯å¡«ï¼‰æ‰è½ï¼šé«˜ç´šç´ æâ€¦",
          "ï¼ˆå¯å¡«ï¼‰æ‰è½ï¼šç¨€æœ‰éƒ¨ä½â€¦"
        ],
        mount: "å¯ä¹˜é¨é£›è¡Œï¼Œé©åˆé•·è·é›¢æ¢ç´¢èˆ‡é«˜é€Ÿç§»å‹•ã€‚",
        paldb: "https://paldb.cc/tw/Jetragon",
        map: "https://palworld.gg/zh-Hant/map"
      }
    ];

    // ===== State =====
    const $ = (id) => document.getElementById(id);

    const listView = $("listView");
    const detailView = $("detailView");
    const cards = $("cards");

    const searchInput = $("searchInput");
    const elementSel = $("elementSel");
    const roleSel = $("roleSel");
    const resetBtn = $("resetBtn");
    const densityBtn = $("densityBtn");
    const paldbBtn = $("paldbBtn");
    const googleBtn = $("googleBtn");
    const cseWrap = $("cseWrap");

    let dense = false;
    let lastScrollY = 0;

    function saveScroll(){
      lastScrollY = window.scrollY || 0;
      sessionStorage.setItem("pal_list_scroll", String(lastScrollY));
    }
    function restoreScroll(){
      const v = sessionStorage.getItem("pal_list_scroll");
      if (v) window.scrollTo(0, Number(v));
    }

    function setDenseMode(on){
      dense = on;
      // Dense mode reduces paddings/height a bit
      document.querySelectorAll(".card").forEach(c=>{
        c.style.padding = on ? "10px" : "14px";
      });
      document.querySelectorAll(".media").forEach(m=>{
        m.style.minHeight = on ? "190px" : "220px";
      });
    }

    function matches(pal, q, el, role){
      const query = (q || "").trim().toLowerCase();
      const elOk = !el || pal.element === el;
      const roleOk = !role || pal.role.includes(role);

      if (!query) return elOk && roleOk;

      const hay = [
        pal.name, pal.en, pal.element, pal.rarity,
        pal.role.join(" "),
        pal.keywords.join(" "),
        pal.desc
      ].join(" ").toLowerCase();

      return elOk && roleOk && hay.includes(query);
    }

    function render(){
      cards.innerHTML = "";
      const q = searchInput.value;
      const el = elementSel.value;
      const role = roleSel.value;

      const list = PALS.filter(p => matches(p, q, el, role));

      // ä½ èªªåªè¦ä¸€å€‹ç©ºæ¸¦é¾ï¼šä½†ç¯©é¸é‚„æ˜¯ä¿ç•™ï¼Œä¹‹å¾ŒåŠ å¤šéš»ç›´æ¥å¯ç”¨
      list.forEach(pal => {
        const card = document.createElement("div");
        card.className = "card";
        card.onclick = () => openDetail(pal.id);

        card.innerHTML = `
          <div class="media"><img alt="${pal.name}" src="${pal.img}"></div>
          <div class="meta">
            <p class="name">${pal.name}</p>
            <p class="line">${pal.element}ãƒ»${pal.role.join(" / ")}ãƒ»${pal.rarity}</p>
            <div class="chips">
              <span class="chip">å±¬æ€§ï¼š${pal.element}</span>
              <span class="chip">å®šä½ï¼š${pal.role.join(" / ")}</span>
              <span class="chip">ç¨€æœ‰åº¦ï¼š${pal.rarity}</span>
            </div>
          </div>
        `;

        cards.appendChild(card);
      });

      setDenseMode(dense);
    }

    function openDetail(id){
      const pal = PALS.find(p => p.id === id);
      if (!pal) return;

      saveScroll();

      $("detailTitle").textContent = pal.name;
      $("detailSub").textContent = `${pal.element} / ${pal.role.join(" / ")} / ${pal.rarity}`;

      $("detailImg").src = pal.img;
      $("detailName").textContent = `${pal.name}ï¼ˆ${pal.en}ï¼‰`;
      $("detailDesc").textContent = pal.desc;

      $("chipElement").textContent = `å±¬æ€§ï¼š${pal.element}`;
      $("chipRole").textContent = `å®šä½ï¼š${pal.role.join(" / ")}`;
      $("chipRarity").textContent = `ç¨€æœ‰åº¦ï¼š${pal.rarity}`;

      const dropsEl = $("drops");
      dropsEl.innerHTML = "";
      (pal.drops || []).forEach(t=>{
        const li = document.createElement("li");
        li.textContent = t;
        dropsEl.appendChild(li);
      });

      $("mount").textContent = pal.mount || "ï¼ˆå°šæœªå¡«å¯«ï¼‰";

      // buttons
      $("openPaldb").onclick = () => window.open(pal.paldb, "_blank", "noopener");
      $("openMap").onclick = () => window.open(pal.map, "_blank", "noopener");

      // Google official search (CSE) â€“ open new tab google query (optional)
      $("openGoogle").onclick = () => {
        const q = encodeURIComponent(`${pal.name} ${pal.en}`);
        window.open(`https://www.google.com/search?q=${q}`, "_blank", "noopener");
      };

      // Switch view
      listView.style.display = "none";
      detailView.style.display = "block";
      window.scrollTo(0,0);
    }

    function backToList(){
      detailView.style.display = "none";
      listView.style.display = "block";
      // restore scroll position
      restoreScroll();
    }

    // ===== Events =====
    $("backBtn").addEventListener("click", backToList);

    resetBtn.addEventListener("click", () => {
      searchInput.value = "";
      elementSel.value = "";
      roleSel.value = "";
      render();
    });

    densityBtn.addEventListener("click", () => {
      dense = !dense;
      setDenseMode(dense);
    });

    paldbBtn.addEventListener("click", () => {
      const pal = PALS[0];
      window.open(pal.paldb, "_blank", "noopener");
    });

    googleBtn.addEventListener("click", () => {
      const show = cseWrap.style.display !== "block";
      cseWrap.style.display = show ? "block" : "none";
      if (show) {
        // small scroll into view for convenience
        cseWrap.scrollIntoView({behavior:"smooth", block:"nearest"});
      }
    });

    [searchInput, elementSel, roleSel].forEach(el => {
      el.addEventListener("input", render);
      el.addEventListener("change", render);
    });

    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        if (detailView.style.display === "block") backToList();
        else if (cseWrap.style.display === "block") cseWrap.style.display = "none";
      }
    });

    // ===== Init =====
    render();
  </script>
</body>
</html>


